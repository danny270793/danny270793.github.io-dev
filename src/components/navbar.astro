---
const { anchors = true } = Astro.props;
---

<!-- Modern Sidebar with Tailwind -->
<div
  id="sidebar"
  class="fixed left-0 top-0 h-full w-80 bg-white/95 backdrop-blur-2xl border-r border-slate-200/50 shadow-2xl transform -translate-x-full transition-transform duration-300 ease-in-out z-50"
>
  <!-- Sidebar Header -->
  <div class="bg-gradient-to-r from-blue-600 to-indigo-600 text-white p-6">
    <div class="flex items-center">
      <div class="w-12 h-12 bg-white/20 rounded-full flex items-center justify-center mr-4">
        <i class="fa fa-user-circle text-2xl"></i>
      </div>
      <div>
        <h3 class="text-xl font-bold">Danny Vaca</h3>
        <p class="text-blue-100 text-sm">Software Engineer</p>
      </div>
    </div>
  </div>
  
  <!-- Navigation Links -->
  <nav class="p-4 space-y-2">
    <a
      href={anchors ? "#hero" : "/#hero"}
      class="nav-link flex items-center px-4 py-3 text-slate-700 hover:text-blue-600 hover:bg-blue-50 rounded-xl transition-all duration-200 group"
    >
      <i class="fa fa-home mr-4 text-blue-500 group-hover:text-blue-600"></i>
      <span class="font-medium">Home</span>
    </a>
    <a
      href={anchors ? "#philosophy" : "/#philosophy"}
      class="nav-link flex items-center px-4 py-3 text-slate-700 hover:text-blue-600 hover:bg-blue-50 rounded-xl transition-all duration-200 group"
    >
      <i class="fa fa-code mr-4 text-blue-500 group-hover:text-blue-600"></i>
      <span class="font-medium">Philosophy</span>
    </a>
    <a
      href={anchors ? "#education" : "/#education"}
      class="nav-link flex items-center px-4 py-3 text-slate-700 hover:text-blue-600 hover:bg-blue-50 rounded-xl transition-all duration-200 group"
    >
      <i class="fa fa-graduation-cap mr-4 text-blue-500 group-hover:text-blue-600"></i>
      <span class="font-medium">Education</span>
    </a>
    <a
      href={anchors ? "#certifications" : "/#certifications"}
      class="nav-link flex items-center px-4 py-3 text-slate-700 hover:text-blue-600 hover:bg-blue-50 rounded-xl transition-all duration-200 group"
    >
      <i class="fa fa-certificate mr-4 text-blue-500 group-hover:text-blue-600"></i>
      <span class="font-medium">Certifications</span>
    </a>
    <a
      href={anchors ? "#open-source" : "/#open-source"}
      class="nav-link flex items-center px-4 py-3 text-slate-700 hover:text-blue-600 hover:bg-blue-50 rounded-xl transition-all duration-200 group"
    >
      <i class="fa fa-code-fork mr-4 text-blue-500 group-hover:text-blue-600"></i>
      <span class="font-medium">Open Source</span>
    </a>
    <a 
      href={anchors ? "#projects" : "/#projects"} 
      class="nav-link flex items-center px-4 py-3 text-slate-700 hover:text-blue-600 hover:bg-blue-50 rounded-xl transition-all duration-200 group"
    >
      <i class="fa fa-laptop mr-4 text-blue-500 group-hover:text-blue-600"></i>
      <span class="font-medium">Projects</span>
    </a>
    <a
      href={anchors ? "#technologies" : "/#technologies"}
      class="nav-link flex items-center px-4 py-3 text-slate-700 hover:text-blue-600 hover:bg-blue-50 rounded-xl transition-all duration-200 group"
    >
      <i class="fa fa-cogs mr-4 text-blue-500 group-hover:text-blue-600"></i>
      <span class="font-medium">Technologies</span>
    </a>
    <a
      href={anchors ? "#contact" : "/#contact"}
      class="nav-link flex items-center px-4 py-3 text-slate-700 hover:text-blue-600 hover:bg-blue-50 rounded-xl transition-all duration-200 group"
    >
      <i class="fa fa-envelope mr-4 text-blue-500 group-hover:text-blue-600"></i>
      <span class="font-medium">Contact</span>
    </a>
  </nav>

  <!-- Sidebar Footer -->
  <div class="absolute bottom-0 left-0 right-0 p-4 bg-slate-50/80 backdrop-blur-sm border-t border-slate-200/50">
    <div class="text-center text-slate-500 text-sm">
      <i class="fa fa-heart text-red-500 mr-1"></i>
      Made with passion
    </div>
  </div>
</div>

<!-- Overlay -->
<div 
  id="overlay" 
  class="fixed inset-0 bg-black/50 backdrop-blur-sm opacity-0 invisible transition-all duration-300 z-40"
>
</div>

<!-- Top Navigation Bar -->
<nav class="fixed top-0 left-0 right-0 z-40 transition-all duration-300">
  <div class="bg-white/90 backdrop-blur-lg border-b border-slate-200/50 shadow-sm">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center h-16">
        <!-- Mobile menu button -->
        <button 
          id="openButton" 
          class="lg:hidden inline-flex items-center justify-center w-10 h-10 rounded-lg text-slate-600 hover:text-blue-600 hover:bg-blue-50 transition-all duration-200"
          title="Open Navigation"
        > 
          <i class="fa fa-bars text-lg"></i>
        </button>
        
        <!-- Logo/Name -->
        <div class="flex items-center">
          <a href="/" class="flex items-center space-x-3">
            <div class="w-8 h-8 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center">
              <span class="text-white font-bold text-sm">DV</span>
            </div>
            <div class="hidden sm:block">
              <h1 class="text-xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent">
                Danny Vaca
              </h1>
              <p class="text-xs text-slate-500">Software Engineer</p>
            </div>
          </a>
        </div>

        <!-- Desktop Navigation -->
        <div class="hidden lg:flex items-center space-x-1">
          <a 
            href={anchors ? "#philosophy" : "/#philosophy"} 
            class="px-4 py-2 text-slate-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all duration-200 font-medium desktop-nav"
          >
            <i class="fa fa-code mr-2"></i>Philosophy
          </a>
          <a 
            href={anchors ? "#projects" : "/#projects"} 
            class="px-4 py-2 text-slate-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all duration-200 font-medium desktop-nav"
          >
            <i class="fa fa-laptop mr-2"></i>Projects
          </a>
          <a 
            href={anchors ? "#certifications" : "/#certifications"} 
            class="px-4 py-2 text-slate-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all duration-200 font-medium desktop-nav"
          >
            <i class="fa fa-certificate mr-2"></i>Certifications
          </a>
          <a 
            href={anchors ? "#contact" : "/#contact"} 
            class="px-4 py-2 text-white bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 rounded-lg transition-all duration-200 font-medium transform hover:scale-105"
          >
            <i class="fa fa-envelope mr-2"></i>Contact
          </a>
        </div>
      </div>
    </div>
  </div>
</nav>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const sidebar = document.getElementById("sidebar");
    const openButton = document.getElementById("openButton");
    const overlay = document.getElementById("overlay");
    const navbar = document.querySelector("nav");
    
    // Enhanced sidebar toggle function
    const toggleSidebar = (show: boolean) => {
      if (sidebar && overlay) {
        if (show) {
          sidebar.classList.remove("-translate-x-full");
          overlay.classList.remove("opacity-0", "invisible");
          overlay.classList.add("opacity-100", "visible");
          document.body.style.overflow = "hidden";
        } else {
          sidebar.classList.add("-translate-x-full");
          overlay.classList.add("opacity-0", "invisible");
          overlay.classList.remove("opacity-100", "visible");
          document.body.style.overflow = "";
        }
      }
    };

    // Event listeners
    openButton?.addEventListener("click", () => toggleSidebar(true));
    overlay?.addEventListener("click", () => toggleSidebar(false));
    
    // Close sidebar when clicking nav links
    document.querySelectorAll(".nav-link").forEach((barItem) => {
      barItem.addEventListener("click", () => toggleSidebar(false));
    });
    
    // Enhanced keyboard navigation
    window.addEventListener("keydown", (e) => {
      if (e.key === "Escape") toggleSidebar(false);
    });

    // Navbar scroll effect
    let lastScrollTop = 0;
    window.addEventListener("scroll", () => {
      const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
      
      if (navbar) {
        const navDiv = navbar.querySelector('div');
        if (scrollTop > 100) {
          navDiv?.classList.add("bg-white/95", "shadow-lg");
          navDiv?.classList.remove("bg-white/90");
        } else {
          navDiv?.classList.remove("bg-white/95", "shadow-lg");
          navDiv?.classList.add("bg-white/90");
        }
      }
      
      lastScrollTop = scrollTop;
    });

    // Enhanced active navigation highlighting
    const observerOptions = {
      threshold: 0.3,
      rootMargin: '-80px 0px -80px 0px'
    };

    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          const id = entry.target.getAttribute('id');
          if (id) {
            // Remove active classes from all nav links
            document.querySelectorAll('.nav-link, .desktop-nav').forEach(link => {
              link.classList.remove('bg-blue-100', 'text-blue-700', 'bg-blue-50', 'text-blue-600');
            });
            
            // Add active classes to current section links
            document.querySelectorAll(`[href="#${id}"]`).forEach(link => {
              if (link.classList.contains('nav-link')) {
                link.classList.add('bg-blue-100', 'text-blue-700');
              } else if (link.classList.contains('desktop-nav')) {
                link.classList.add('bg-blue-50', 'text-blue-600');
              }
            });
          }
        }
      });
    }, observerOptions);

    // Observe sections
    document.querySelectorAll('section[id], div[id]').forEach(section => {
      observer.observe(section);
    });

    // Smooth scroll for anchor links
    document.querySelectorAll('a[href^="#"]').forEach(link => {
      link.addEventListener('click', function(e) {
        e.preventDefault();
        const targetId = this.getAttribute('href');
        const targetElement = document.querySelector(targetId);
        
        if (targetElement) {
          const offsetTop = (targetElement as HTMLElement).offsetTop - 80; // Account for fixed navbar
          window.scrollTo({
            top: offsetTop,
            behavior: 'smooth'
          });
        }
      });
    });
  });
</script>
